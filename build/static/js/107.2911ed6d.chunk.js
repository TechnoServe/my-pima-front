"use strict";(self.webpackChunkmypima_front=self.webpackChunkmypima_front||[]).push([[107],{30325:()=>{},30589:(e,s,t)=>{t.d(s,{A:()=>f});var i=t(65043),a=t(73216),n=t(58786),r=t(67805),o=t(3438),l=t(85369),d=t(68926),c=t(11238),m=t(88250);const _=()=>{const e=new Date,s=Intl.DateTimeFormat().resolvedOptions().timeZone;return`${e.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})}_at_${e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:s})}`};var p=t(45476),u=t(84548),h=t(70579);const x={rows:{style:{minHeight:"30px",cursor:"pointer"}},headCells:{style:{paddingLeft:"8px",paddingRight:"8px",backgroundColor:"#1b2a4e",color:"white"}},cells:{style:{paddingLeft:"5px",paddingRight:"5px",paddingTop:"5px",paddingBottom:"5px"}}},g=e=>{let{handleCSVExport:s,handleExcelExport:t,tableRowItem:i}=e;return(0,h.jsxs)("div",{className:"export-buttons",children:["trainsessionapprov"!==i&&(0,h.jsxs)(o.A,{variant:"outlined",sx:{color:"#1b2a4e",borderColor:"#1b2a4e"},onClick:s,children:[(0,h.jsx)(l.Mbn,{style:{marginRight:"5px"}})," CSV"]}),(0,h.jsxs)(o.A,{variant:"outlined",sx:{color:"#1b2a4e",borderColor:"#1b2a4e"},onClick:t,children:[(0,h.jsx)(l.Mbn,{style:{marginRight:"5px"}}),"trainsessionapprov"!==i?"Excel":"Download Report"]})]})},f=e=>{let{columns:s,data:t,filter:l,tableRowItem:f,allAttendances:b,selectedProject:j}=e;const v=f||window.location.pathname.split("/")[2],[A,y]=(0,i.useState)({ts_id:null}),[S,C]=(0,i.useState)(!1),[N,F]=(0,i.useState)(!1),[I,w]=(0,i.useState)(null),[k,$]=(0,i.useState)(""),[D,T]=(0,i.useState)([]),[E,M]=(0,i.useState)(!1),[R,L]=(0,i.useState)(null),V=(0,a.Zp)(),O=(0,m.I)(u.jq,{variables:{tsId:A&&A.ts_id?A.ts_id:""},skip:!A}),G="traingroup"===v?"mypima_training_group":"trainsession"===v?"mypima_training_session":"participants"===v?"Participants Data":"farmvisit"===v?"mypima_farm_visit":"mypima_attendance";(0,i.useEffect)((()=>{var e,s;O.loading||200!==(null===(e=O.data)||void 0===e||null===(s=e.trainingSessionImage)||void 0===s?void 0:s.status)||(F(!1),w(O.data.trainingSessionImage.trainingSessionImage))}),[O]);return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"table-header-actions "+(l?"":"no-filter"),children:[l&&(0,h.jsx)(o.A,{className:"filter-button",children:"Filter"}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,h.jsxs)("div",{className:"search-container",children:[(0,h.jsx)("input",{type:"text",placeholder:"Search...",value:k,onChange:e=>{const i=e.target.value.toLowerCase(),a=t.filter((e=>s.some((s=>{const t=e[s.id];return null===t||void 0===t?void 0:t.toString().toLowerCase().includes(i)}))));T(a),$(e.target.value)}}),(0,h.jsx)("span",{className:"search-icon",children:(0,h.jsx)(r.LUJ,{})})]}),(0,h.jsx)(g,{handleCSVExport:()=>{if(!t||0===t.length)return void alert("No data available for export.");let e=[...s];if("farmvisit"===v){const s=[{id:"household_tns_id"},{id:"pima_farmer_id"},{id:"pima_household_id"}];e=[...e,...s]}const i=["num","Project","first_name","middle_name","last_name","gender","age","coffee_tree_numbers","number_of_coffee_plots","phone_number","a0EOj000002FMGnMAO"===j||"a0EOj000002C7ivMAC"===j?"national_identification_id":"a0EOj000003E0knMAC"===j?"growers_number":"coop_membership_number","location","farmer_sf_id","tns_id","hh_number","sf_household_id","farmer_number","ffg_id","training_group","status","farmer_trainer","a0EOj000003E0knMAC"===j?"agronomy_advisor":"business_advisor","create_in_commcare"];if("participants"===f){const e=new Map;b.filter((e=>t.some((s=>s.p_id===e.participant_id)))).forEach((s=>{const{attendance_status:t,participant_id:i,module_number:a,module_name:n,module_id:r}=s,o=`${a}-${n}-${r}`;e.has(o)||e.set(o,{});e.get(o)[i]="Present"===t?"1":"0"}));for(const[t]of e)i.push(t);const s=k.length>0?D.map((s=>{const t={...s};for(const[i,a]of e)t[i]=a[s.p_id]||"";return t})):t.map((s=>{const t={...s};for(const[i,a]of e)t[i]=a[s.p_id]||"";return t}));t=s}const a=t.map((e=>{let{tg_id:s,ts_id:t,p_id:i,attendance_id:a,fv_id:n,__typename:r,...o}=e;return o})),n=(0,d.df)({filename:G,columnHeaders:"participants"===f?i:e.map((e=>e.id))}),r=(0,d.Y_)(n)(a);r?((0,d.RG)(n)(r),console.log("Download successful"),console.log("Config:",n),console.log("Data:",t),console.log("CSV Content:",r)):console.error("Output is empty. Is your data formatted correctly?")},handleExcelExport:()=>{const e={header:s.map((e=>e.id)),body:t.map((e=>{let{tg_id:s,ts_id:t,p_id:i,attendance_id:a,fv_id:n,__typename:r,...o}=e;return Object.values(o)}))},i=t.reduce(((e,s)=>{let{farmer_trainer:t,session_image_status:i}=s;const a=`${t}_${i}`;return e[a]||(e[a]={farmer_trainer:t,session_image_status:i,count:0}),e[a].count+=1,e}),{}),a={header:["farmer_trainer","session_image_status","count"],body:Object.values(i).map((e=>Object.values(e)))},n=c.Wp.book_new(),r=c.Wp.json_to_sheet([e.header,...e.body],{skipHeader:!0}),o=c.Wp.json_to_sheet([a.header,...a.body],{skipHeader:!0});c.Wp.book_append_sheet(n,o,"Summary by Trainer"),c.Wp.book_append_sheet(n,r,"Sessions Data"),(0,c._h)(n,`${G}_${_()}.xlsx`)},tableRowItem:f})]})]}),(0,h.jsx)(n.Ay,{columns:s,data:k.length>0?D:t,onRowClicked:e=>{y(e);const s={trainsession:e.ts_id,traingroup:e.tg_id,participants:e.p_id,farmvisit:e.fv_ids,trainsessionapprov:e.ts_id}[f]||e.attendance_id;"farmvisit"!==f&&"trainsessionapprov"!==f?V(`/in/${f}/${s}`):"farmvisit"===f?(L(e.fv_id),M(!0)):"trainsessionapprov"===f&&(C(!0),F(!0))},pagination:!0,highlightOnHover:!0,customStyles:x,className:"table-container"}),S&&(0,h.jsx)(p.A,{open:S,handleClose:()=>C(!1),id:A.ts_id,data:A,isVerified:A.is_verified,imageStatus:A.session_image_status,sessionImageUrl:I,selectedProject:j,loading:N})]})}},45476:(e,s,t)=>{t.d(s,{A:()=>u});var i=t(65043),a=t(83462),n=t(17392),r=t(81637),o=t(94496),l=t(35316),d=t(68903),c=t(27149),m=t(34535),_=t(70579);const p=(0,m.Ay)("div")({position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"}),u=e=>{let{open:s,handleClose:t,sessionImageUrl:m,data:u,selectedProject:h,loading:x}=e;console.log(u);const[g,f]=(0,i.useState)(!1),[b]=(0,i.useState)(!1),j=()=>{f((e=>!e))};return(0,_.jsx)(_.Fragment,{children:x?(0,_.jsxs)(a.A,{open:s,keepMounted:!0,fullWidth:!0,"aria-describedby":"alert-dialog-slide-description",children:[(0,_.jsx)("div",{style:{margin:"20px"},children:(0,_.jsx)(n.A,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:8,top:8,color:"#2b2b2b"},children:(0,_.jsx)(c.m6K,{})})}),(0,_.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,_.jsx)(r.A,{}),(0,_.jsx)(o.A,{variant:"h6",style:{marginLeft:"10px"},children:"Loading Image..."})]})]}):(0,_.jsxs)(a.A,{open:s,keepMounted:!0,fullWidth:!0,"aria-describedby":"alert-dialog-slide-description",children:[b&&(0,_.jsx)(p,{children:(0,_.jsx)(r.A,{})}),(0,_.jsxs)("div",{style:{margin:"20px"},children:[(0,_.jsx)(n.A,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:8,top:8,color:"#2b2b2b"},children:(0,_.jsx)(c.m6K,{})}),(0,_.jsx)(o.A,{variant:"h6",children:"Session Image"})]}),(0,_.jsx)(l.A,{children:(0,_.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,_.jsxs)(d.Ay,{item:!0,xs:12,sm:6,children:[(0,_.jsxs)(o.A,{variant:"body1",children:[(0,_.jsx)("strong",{children:"Male Attendees:"})," ",u.total_males]}),(0,_.jsxs)(o.A,{variant:"body1",children:[(0,_.jsx)("strong",{children:"Female Attendees:"})," ",u.total_females]}),(0,_.jsxs)(o.A,{variant:"body1",children:[(0,_.jsx)("strong",{children:"Total Attendees:"})," ",u.total_males+u.total_females]}),(0,_.jsxs)(o.A,{variant:"body1",children:[(0,_.jsx)("strong",{children:"Session Date:"})," ",u.session_date]}),(0,_.jsxs)(o.A,{variant:"body1",children:[(0,_.jsx)("strong",{children:"Farmer Trainer:"})," ",u.farmer_trainer]}),(0,_.jsxs)(o.A,{variant:"body1",children:[(0,_.jsx)("strong",{children:"Session Module:"})," ",u.ts_module]}),(0,_.jsxs)(o.A,{variant:"body1",children:[(0,_.jsx)("strong",{children:"FFG:"})," ",u.ts_group]})]}),(0,_.jsx)(d.Ay,{item:!0,xs:12,sm:6,children:(0,_.jsxs)("div",{style:{position:"relative"},children:[(0,_.jsx)("img",{src:m,alt:"session_pic",style:{width:"100%",height:"auto",cursor:g?"zoom-out":"zoom-in"},onClick:j}),g?(0,_.jsx)(n.A,{"aria-label":"shrink",onClick:j,sx:{position:"absolute",bottom:8,right:8,color:"#fff"},children:(0,_.jsx)(c.Llp,{})}):(0,_.jsx)(n.A,{"aria-label":"expand",onClick:j,sx:{position:"absolute",bottom:8,right:8,color:"#fff"},children:(0,_.jsx)(c.T$Z,{})})]})})]})})]})})}},47665:(e,s,t)=>{t.d(s,{A:()=>n});t(65043),t(30325);var i=t(3388),a=t(70579);const n=e=>{let{heading:s,paragraph:t}=e;return(0,a.jsxs)("div",{className:"details__content",children:[(0,a.jsx)(i._Mh,{color:"#3A57E8"}),(0,a.jsxs)("div",{className:"details__content2",children:[(0,a.jsx)("p",{className:"details__para",children:s}),(0,a.jsx)("p",{className:"details__para2",children:t})]})]})}},55293:(e,s,t)=>{t.d(s,{L7:()=>f,Ay:()=>b});var i=t(65043),a=t(7353),n=t(94496),r=t(83625),o=t(24056),l=t(61596),d=(t(30325),t(47665)),c=t(70579);const m=e=>{let{details:s}=e;return(0,c.jsx)("div",{children:(0,c.jsxs)(l.A,{elevation:1,sx:{maxWidth:"30%"},children:[(0,c.jsx)("div",{className:"details__title",children:s.tg_name}),(0,c.jsxs)("div",{style:{padding:"10px",paddingLeft:"20px"},children:[(0,c.jsx)(d.A,{heading:"# of Registered Farmers",paragraph:null!==s.total_participants?s.total_participants:"N/A"}),(0,c.jsx)(d.A,{heading:"Business Advisor",paragraph:s.business_advisor}),(0,c.jsx)(d.A,{heading:"Farmer Trainer",paragraph:s.farmer_trainer}),(0,c.jsx)(d.A,{heading:"TNS ID",paragraph:s.tns_id||"N/A"})]})]})})};var _=t(43845),p=t(30589);const u=e=>{let{trainingSessions:s}=e;const t=[{id:"num",name:"No.",selector:e=>e.num,sortable:!0},{id:"ts_module",name:"Session Name",grow:2,selector:e=>e.ts_module,sortable:!0},{id:"tns_id",name:"TNS ID",selector:e=>e.tns_id,sortable:!0},{id:"farmer_trainer",name:"Farmer Trainer",selector:e=>e.farmer_trainer,sortable:!0},{id:"total_males",name:"MA",selector:e=>e.total_males,sortable:!0},{id:"total_females",name:"FA",selector:e=>e.total_females,sortable:!0},{id:"is_verified",name:"Is Session Verified?",selector:e=>(0,c.jsx)("div",{children:e.is_verified?(0,c.jsx)(_.A,{label:"Yes",color:"success",variant:"outlined"}):(0,c.jsx)(_.A,{label:"No",color:"error",variant:"outlined"})}),sortable:!0},{id:"session_image_status",name:"Session Image Status",grow:2,selector:e=>(0,c.jsx)("div",{children:e.is_verified?"approved"===e.session_image_status?(0,c.jsx)(_.A,{label:e.session_image_status,color:"success",variant:"outlined",title:e.session_image_status}):(0,c.jsx)(_.A,{label:e.session_image_status,color:"error",variant:"outlined",title:e.session_image_status}):(0,c.jsx)(_.A,{label:"not_verified",color:"secondary",variant:"outlined",title:"not_verified"})}),sortable:!0},{id:"session_date",name:"Session Date",selector:e=>e.session_date,sortable:!0}],i=s?s.map(((e,s)=>({num:s+1,ts_id:e.ts_id,ts_name:e.ts_name,ts_module:e.ts_module,tns_id:e.tns_id||"N/A",farmer_trainer:e.farmer_trainer||"N/A",ts_status:e.ts_status,total_males:e.total_males,total_females:e.total_females,has_image:e.has_image,is_verified:e.is_verified,session_image_status:e.session_image_status,session_date:e.session_date||"N/A"}))):[];return(0,c.jsx)("div",{children:(0,c.jsx)(p.A,{columns:t,data:i,tableRowItem:"trainsession"})})},h=e=>{let{details:s,farmVisits:t}=e;const i=t?t.map(((e,s)=>({num:s+1,fv_id:e.fv_id,fv_name:e.fv_name,training_group:e.training_group,training_session:e.training_session,tns_id:e.tns_id,farm_visited:e.farm_visited,household_id:e.household_id,farmer_trainer:e.farmer_trainer,has_training:e.has_training,date_visited:e.date_visited}))):[];return(0,c.jsx)("div",{children:(0,c.jsx)(p.A,{columns:[{id:"num",name:"No.",selector:e=>e.num,sortable:!0},{id:"training_group",name:"FFG Name",selector:e=>e.training_group,sortable:!0},{id:"tns_id",name:"TNS ID",selector:e=>e.tns_id,sortable:!0},{id:"farm_visited",name:"Farm Visited",selector:e=>e.farm_visited,sortable:!0},{id:"farmer_trainer",name:"Farmer Trainer",selector:e=>e.farmer_trainer,sortable:!0},{id:"date_visited",name:"Date Visited",selector:e=>e.date_visited,sortable:!0}],data:i,tableRowItem:"farmvisit",details:s})})},x=e=>{let{participants:s}=e;const t=s?s.map(((e,s)=>({num:s+1,p_id:e.p_id,full_name:`${e.first_name} ${"null"!==e.middle_name?e.middle_name:" "} ${e.last_name}`,gender:"m"===e.gender?"Male":"Female",location:e.location,tns_id:e.tns_id,status:e.status,farmer_trainer:e.farmer_trainer,business_advisor:e.business_advisor}))):[];return(0,c.jsx)("div",{children:(0,c.jsx)(p.A,{columns:[{id:"num",name:"No.",selector:e=>e.num,sortable:!0},{id:"full_name",name:"Full Name",selector:e=>e.full_name,sortable:!0},{id:"gender",name:"Gender",selector:e=>e.gender,sortable:!0},{id:"location",name:"Location",selector:e=>e.location,sortable:!0},{id:"tns_id",name:"TNS ID",selector:e=>e.tns_id,sortable:!0},{id:"farmer_trainer",name:"Farmer Trainer",selector:e=>e.farmer_trainer,sortable:!0},{id:"business_advisor",name:"Business Advisor",selector:e=>e.business_advisor,sortable:!0}],data:t,tableRowItem:"participants"})})};function g(e){const{children:s,value:t,index:i,...r}=e;return(0,c.jsx)("div",{role:"tabpanel",hidden:t!==i,id:`simple-tabpanel-${i}`,"aria-labelledby":`simple-tab-${i}`,...r,children:t===i&&(0,c.jsx)(a.A,{sx:{p:3},children:(0,c.jsx)(n.A,{children:s})})})}function f(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function b(e){let{details:s,trainingSessions:t,farmVisits:n,participants:l}=e;const[d,_]=(0,i.useState)(0);return(0,c.jsxs)(a.A,{sx:{width:"100%",marginTop:"20px"},children:[(0,c.jsx)(a.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,c.jsxs)(r.A,{value:d,onChange:(e,s)=>{_(s)},"aria-label":"basic tabs example",children:[(0,c.jsx)(o.A,{label:"FFG Details",...f(0)}),(0,c.jsx)(o.A,{label:"FFG sessions",...f(1)}),(0,c.jsx)(o.A,{label:"FFG Farm Visits",...f(2)}),(0,c.jsx)(o.A,{label:"FFG Participants",...f(2)})]})}),(0,c.jsx)(g,{value:d,index:0,children:(0,c.jsx)(m,{details:s})}),(0,c.jsx)(g,{value:d,index:1,children:(0,c.jsx)(u,{trainingSessions:t})}),(0,c.jsx)(g,{value:d,index:2,children:(0,c.jsx)(h,{farmVisits:n})}),(0,c.jsx)(g,{value:d,index:3,children:(0,c.jsx)(x,{participants:l})})]})}},82407:(e,s,t)=>{t.d(s,{A:()=>l});t(65043);var i=t(22698),a=t(35475),n=t(51640),r=t(70579);const o=(0,n.A)(a.N_)((e=>{let{theme:s}=e;return{textDecoration:"none",color:"inherit",transition:"color 0.3s ease-in-out","&:hover":{color:"#25245D",fontWeight:"600"}}})),l=e=>{let{name:s,firstItem:t,linkTo:a}=e;return(0,r.jsx)("div",{role:"presentation",children:(0,r.jsxs)(i.A,{"aria-label":"breadcrumb",sx:{fontSize:"12px",cursor:"pointer"},children:[(0,r.jsx)(o,{to:`/in/${a}`,children:t}),(0,r.jsx)(o,{href:"","aria-current":"page",children:s.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")})]})})}}}]);
//# sourceMappingURL=107.2911ed6d.chunk.js.map