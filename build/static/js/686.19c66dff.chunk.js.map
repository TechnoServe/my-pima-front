{"version":3,"file":"static/js/686.19c66dff.chunk.js","mappings":"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","sources":["pages/AAPerformance.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport Select from \"react-select\";\r\nimport { gql, useQuery } from \"@apollo/client\";\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n} from \"recharts\";\r\nimport { BsDownload } from \"react-icons/bs\";\r\nimport * as XLSX from \"xlsx\";\r\nimport \"./AAList.css\";\r\nimport { useOutletContext } from \"react-router-dom\";\r\nimport { Typography } from \"@mui/material\";\r\nimport LoadingScreen from \"../components/LoadingScreen\";\r\n\r\nconst GET_AAS = gql`\r\n  query GetAAs($project_id: String!) {\r\n    getPerformanceByAA(project_id: $project_id) {\r\n      message\r\n      status\r\n      data {\r\n        id\r\n        name\r\n        monthlyCounts {\r\n          date\r\n          trainingCount\r\n          dpoCount\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst AAList = () => {\r\n  const { activeProject } = useOutletContext();\r\n\r\n  const { loading, error, data } = useQuery(GET_AAS, {\r\n    variables: { project_id: activeProject },\r\n  });\r\n  \r\n  const [selectedAA, setSelectedAA] = useState(null);\r\n  const [selectWidth, setSelectWidth] = useState(\"auto\");\r\n  const selectRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (selectRef.current && data?.getPerformanceByAA?.data.length > 0) {\r\n      const longestOptionWidth = Math.max(\r\n        ...(data.getPerformanceByAA.data || []).map((aa) => aa.name.length * 8)\r\n      );\r\n      setSelectWidth(`${longestOptionWidth}px`);\r\n    }\r\n  }, [data]);\r\n\r\n  const handleAASelect = (selectedOption) => {\r\n    const selectedAAData = data?.getPerformanceByAA?.data.find(\r\n      (aa) => aa.id === selectedOption.value\r\n    );\r\n    setSelectedAA(selectedAAData);\r\n  };\r\n\r\n  const exportToExcel = () => {\r\n    const fileName = \"AA_Performance_Data.xlsx\";\r\n    const wsData = [];\r\n    data?.getPerformanceByAA?.data.forEach((aa) => {\r\n      aa.monthlyCounts.forEach((mc) => {\r\n        wsData.push({\r\n          Name: aa.name,\r\n          Date: mc.date,\r\n          \"DPO Count\": mc.dpoCount,\r\n          \"Training Count\": mc.trainingCount,\r\n        });\r\n      });\r\n    });\r\n\r\n    const ws = XLSX.utils.json_to_sheet(wsData);\r\n    const wb = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(wb, ws, \"AA_Performance\");\r\n    XLSX.writeFile(wb, fileName);\r\n  };\r\n\r\n  if (loading) return <LoadingScreen />;\r\n\r\n  if (error)\r\n    return (\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          justifyContent: \"center\",\r\n          alignItems: \"center\",\r\n          height: \"100vh\",\r\n        }}\r\n      >\r\n        <Typography color=\"error\">Error loading data</Typography>\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <div className=\"aa-list-container\">\r\n      <h1 className=\"title\">Agronomy Advisor Performance</h1>\r\n      <div className=\"select-export-container\">\r\n        <Select\r\n          className=\"select\"\r\n          options={data?.getPerformanceByAA?.data.map((aa) => ({\r\n            label: aa.name,\r\n            value: aa.id,\r\n          }))}\r\n          onChange={handleAASelect}\r\n          placeholder=\"Select an Agronomy Advisor...\"\r\n          value={\r\n            selectedAA ? { label: selectedAA.name, value: selectedAA.id } : null\r\n          }\r\n          styles={{\r\n            menuPortal: (base) => ({ ...base, zIndex: 9999 }),\r\n          }}\r\n          menuPortalTarget={document.body}\r\n          menuPlacement=\"auto\"\r\n          width={selectWidth}\r\n          ref={selectRef}\r\n        />\r\n        <button className=\"export-button\" onClick={exportToExcel}>\r\n          <BsDownload /> Export to Excel\r\n        </button>\r\n      </div>\r\n      {selectedAA && (\r\n        <div className=\"graph-container\">\r\n          <div className=\"graph-aa\">\r\n            <h4 className=\"graph-title\">\r\n              Performance Chart for {selectedAA.name}\r\n            </h4>\r\n            <LineChart width={600} height={300} data={selectedAA.monthlyCounts}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" />\r\n              <XAxis dataKey=\"date\" tick={{ fontSize: 12 }} />\r\n              <YAxis\r\n                label={{ value: \"Count\", angle: -90, position: \"insideLeft\" }}\r\n                ticks={[0, 20, 40, 60]}\r\n              />\r\n              <Tooltip />\r\n              <Legend />\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey=\"trainingCount\"\r\n                name=\"Training Observations\"\r\n                stroke=\"#007bff\"\r\n              />\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey=\"dpoCount\"\r\n                name=\"Demo Plot Observations\"\r\n                stroke=\"#28a745\"\r\n              />\r\n            </LineChart>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AAList;\r\n"],"names":["GET_AAS","gql","AAList","_data$getPerformanceB4","activeProject","useOutletContext","loading","error","data","useQuery","variables","project_id","selectedAA","setSelectedAA","useState","selectWidth","setSelectWidth","selectRef","useRef","useEffect","_data$getPerformanceB","current","getPerformanceByAA","length","longestOptionWidth","Math","max","map","aa","name","_jsx","LoadingScreen","style","display","justifyContent","alignItems","height","children","Typography","color","_jsxs","className","Select","options","label","value","id","onChange","selectedOption","_data$getPerformanceB2","selectedAAData","find","placeholder","styles","menuPortal","base","zIndex","menuPortalTarget","document","body","menuPlacement","width","ref","onClick","exportToExcel","_data$getPerformanceB3","wsData","forEach","monthlyCounts","mc","push","Name","Date","date","dpoCount","trainingCount","ws","XLSX","json_to_sheet","wb","book_new","book_append_sheet","BsDownload","LineChart","CartesianGrid","strokeDasharray","XAxis","dataKey","tick","fontSize","YAxis","angle","position","ticks","Tooltip","Legend","Line","type","stroke"],"sourceRoot":""}