"use strict";(self.webpackChunkmypima_front=self.webpackChunkmypima_front||[]).push([[918],{21548:(e,t,s)=>{s.d(t,{A:()=>a});s(65043);var i=s(70579);const a=e=>{let{heading:t,figures:s,icon:a,color:n}=e;return(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"card__container",children:(0,i.jsxs)("div",{className:"card__content",children:[(0,i.jsxs)("div",{className:"card__text",children:[(0,i.jsx)("p",{className:"card__text1",children:t}),(0,i.jsx)("p",{className:"card__text2",children:s})]}),(0,i.jsxs)("div",{className:"card__icon",style:{backgroundColor:n},children:[a," "]})]})})})}},30589:(e,t,s)=>{s.d(t,{A:()=>j});var i=s(65043),a=s(73216),n=s(58786),r=s(67805),o=s(3438),l=s(85369),d=s(68926),c=s(11238),m=s(88250);const p=()=>{const e=new Date,t=Intl.DateTimeFormat().resolvedOptions().timeZone;return`${e.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})}_at_${e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:t})}`};var _=s(45476),u=s(84548),h=s(70579);const g={rows:{style:{minHeight:"30px",cursor:"pointer"}},headCells:{style:{paddingLeft:"8px",paddingRight:"8px",backgroundColor:"#1b2a4e",color:"white"}},cells:{style:{paddingLeft:"5px",paddingRight:"5px",paddingTop:"5px",paddingBottom:"5px"}}},x=e=>{let{handleCSVExport:t,handleExcelExport:s,tableRowItem:i}=e;return(0,h.jsxs)("div",{className:"export-buttons",children:["trainsessionapprov"!==i&&(0,h.jsxs)(o.A,{variant:"outlined",sx:{color:"#1b2a4e",borderColor:"#1b2a4e"},onClick:t,children:[(0,h.jsx)(l.Mbn,{style:{marginRight:"5px"}})," CSV"]}),(0,h.jsxs)(o.A,{variant:"outlined",sx:{color:"#1b2a4e",borderColor:"#1b2a4e"},onClick:s,children:[(0,h.jsx)(l.Mbn,{style:{marginRight:"5px"}}),"trainsessionapprov"!==i?"Excel":"Download Report"]})]})},j=e=>{let{columns:t,data:s,filter:l,tableRowItem:j,allAttendances:f,selectedProject:b}=e;const v=j||window.location.pathname.split("/")[2],[y,A]=(0,i.useState)({ts_id:null}),[C,S]=(0,i.useState)(!1),[k,F]=(0,i.useState)(!1),[w,I]=(0,i.useState)(null),[N,E]=(0,i.useState)(""),[R,G]=(0,i.useState)([]),[M,$]=(0,i.useState)(!1),[L,O]=(0,i.useState)(null),D=(0,a.Zp)(),T=(0,m.I)(u.jq,{variables:{tsId:y&&y.ts_id?y.ts_id:""},skip:!y}),W="traingroup"===v?"mypima_training_group":"trainsession"===v?"mypima_training_session":"participants"===v?"Participants Data":"farmvisit"===v?"mypima_farm_visit":"mypima_attendance";(0,i.useEffect)((()=>{var e,t;T.loading||200!==(null===(e=T.data)||void 0===e||null===(t=e.trainingSessionImage)||void 0===t?void 0:t.status)||(F(!1),I(T.data.trainingSessionImage.trainingSessionImage))}),[T]);return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"table-header-actions "+(l?"":"no-filter"),children:[l&&(0,h.jsx)(o.A,{className:"filter-button",children:"Filter"}),(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,h.jsxs)("div",{className:"search-container",children:[(0,h.jsx)("input",{type:"text",placeholder:"Search...",value:N,onChange:e=>{const i=e.target.value.toLowerCase(),a=s.filter((e=>t.some((t=>{const s=e[t.id];return null===s||void 0===s?void 0:s.toString().toLowerCase().includes(i)}))));G(a),E(e.target.value)}}),(0,h.jsx)("span",{className:"search-icon",children:(0,h.jsx)(r.LUJ,{})})]}),(0,h.jsx)(x,{handleCSVExport:()=>{if(!s||0===s.length)return void alert("No data available for export.");let e=[...t];if("farmvisit"===v){const t=[{id:"household_tns_id"},{id:"pima_farmer_id"},{id:"pima_household_id"}];e=[...e,...t]}const i=["num","Project","first_name","middle_name","last_name","gender","age","coffee_tree_numbers","number_of_coffee_plots","phone_number","a0EOj000002FMGnMAO"===b||"a0EOj000002C7ivMAC"===b?"national_identification_id":"a0EOj000003E0knMAC"===b?"growers_number":"coop_membership_number","location","farmer_sf_id","tns_id","hh_number","sf_household_id","farmer_number","ffg_id","training_group","status","farmer_trainer","a0EOj000003E0knMAC"===b?"agronomy_advisor":"business_advisor","create_in_commcare"];if("participants"===j){const e=new Map;f.filter((e=>s.some((t=>t.p_id===e.participant_id)))).forEach((t=>{const{attendance_status:s,participant_id:i,module_number:a,module_name:n,module_id:r}=t,o=`${a}-${n}-${r}`;e.has(o)||e.set(o,{});e.get(o)[i]="Present"===s?"1":"0"}));for(const[s]of e)i.push(s);const t=N.length>0?R.map((t=>{const s={...t};for(const[i,a]of e)s[i]=a[t.p_id]||"";return s})):s.map((t=>{const s={...t};for(const[i,a]of e)s[i]=a[t.p_id]||"";return s}));s=t}const a=s.map((e=>{let{tg_id:t,ts_id:s,p_id:i,attendance_id:a,fv_id:n,__typename:r,...o}=e;return o})),n=(0,d.df)({filename:W,columnHeaders:"participants"===j?i:e.map((e=>e.id))}),r=(0,d.Y_)(n)(a);r?(0,d.RG)(n)(r):console.error("Output is empty. Is your data formatted correctly?")},handleExcelExport:()=>{const e={header:t.map((e=>e.id)),body:s.map((e=>{let{tg_id:t,ts_id:s,p_id:i,attendance_id:a,fv_id:n,__typename:r,...o}=e;return Object.values(o)}))},i=s.reduce(((e,t)=>{let{farmer_trainer:s,session_image_status:i}=t;const a=`${s}_${i}`;return e[a]||(e[a]={farmer_trainer:s,session_image_status:i,count:0}),e[a].count+=1,e}),{}),a={header:["farmer_trainer","session_image_status","count"],body:Object.values(i).map((e=>Object.values(e)))},n=c.Wp.book_new(),r=c.Wp.json_to_sheet([e.header,...e.body],{skipHeader:!0}),o=c.Wp.json_to_sheet([a.header,...a.body],{skipHeader:!0});c.Wp.book_append_sheet(n,o,"Summary by Trainer"),c.Wp.book_append_sheet(n,r,"Sessions Data"),(0,c._h)(n,`${W}_${p()}.xlsx`)},tableRowItem:j})]})]}),(0,h.jsx)(n.Ay,{columns:t,data:N.length>0?R:s,onRowClicked:e=>{A(e);const t={trainsession:e.ts_id,traingroup:e.tg_id,participants:e.p_id,farmvisit:e.fv_ids,trainsessionapprov:e.ts_id}[j]||e.attendance_id;"farmvisit"!==j&&"trainsessionapprov"!==j?D(`/in/${j}/${t}`):"farmvisit"===j?(O(e.fv_id),$(!0)):"trainsessionapprov"===j&&(S(!0),F(!0))},pagination:!0,highlightOnHover:!0,customStyles:g,className:"table-container"}),C&&(0,h.jsx)(_.A,{open:C,handleClose:()=>S(!1),id:y.ts_id,data:y,isVerified:y.is_verified,imageStatus:y.session_image_status,sessionImageUrl:w,selectedProject:b,loading:k})]})}},45476:(e,t,s)=>{s.d(t,{A:()=>u});var i=s(65043),a=s(83462),n=s(17392),r=s(81637),o=s(94496),l=s(35316),d=s(68903),c=s(27149),m=s(34535),p=s(70579);const _=(0,m.Ay)("div")({position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"}),u=e=>{let{open:t,handleClose:s,sessionImageUrl:m,data:u,selectedProject:h,loading:g}=e;console.log(u);const[x,j]=(0,i.useState)(!1),[f]=(0,i.useState)(!1),b=()=>{j((e=>!e))};return(0,p.jsx)(p.Fragment,{children:g?(0,p.jsxs)(a.A,{open:t,keepMounted:!0,fullWidth:!0,"aria-describedby":"alert-dialog-slide-description",children:[(0,p.jsx)("div",{style:{margin:"20px"},children:(0,p.jsx)(n.A,{"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:"#2b2b2b"},children:(0,p.jsx)(c.m6K,{})})}),(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,p.jsx)(r.A,{}),(0,p.jsx)(o.A,{variant:"h6",style:{marginLeft:"10px"},children:"Loading Image..."})]})]}):(0,p.jsxs)(a.A,{open:t,keepMounted:!0,fullWidth:!0,"aria-describedby":"alert-dialog-slide-description",children:[f&&(0,p.jsx)(_,{children:(0,p.jsx)(r.A,{})}),(0,p.jsxs)("div",{style:{margin:"20px"},children:[(0,p.jsx)(n.A,{"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:"#2b2b2b"},children:(0,p.jsx)(c.m6K,{})}),(0,p.jsx)(o.A,{variant:"h6",children:"Session Image"})]}),(0,p.jsx)(l.A,{children:(0,p.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,p.jsxs)(d.Ay,{item:!0,xs:12,sm:6,children:[(0,p.jsxs)(o.A,{variant:"body1",children:[(0,p.jsx)("strong",{children:"Male Attendees:"})," ",u.total_males]}),(0,p.jsxs)(o.A,{variant:"body1",children:[(0,p.jsx)("strong",{children:"Female Attendees:"})," ",u.total_females]}),(0,p.jsxs)(o.A,{variant:"body1",children:[(0,p.jsx)("strong",{children:"Total Attendees:"})," ",u.total_males+u.total_females]}),(0,p.jsxs)(o.A,{variant:"body1",children:[(0,p.jsx)("strong",{children:"Session Date:"})," ",u.session_date]}),(0,p.jsxs)(o.A,{variant:"body1",children:[(0,p.jsx)("strong",{children:"Farmer Trainer:"})," ",u.farmer_trainer]}),(0,p.jsxs)(o.A,{variant:"body1",children:[(0,p.jsx)("strong",{children:"Session Module:"})," ",u.ts_module]}),(0,p.jsxs)(o.A,{variant:"body1",children:[(0,p.jsx)("strong",{children:"FFG:"})," ",u.ts_group]})]}),(0,p.jsx)(d.Ay,{item:!0,xs:12,sm:6,children:(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)("img",{src:m,alt:"session_pic",style:{width:"100%",height:"auto",cursor:x?"zoom-out":"zoom-in"},onClick:b}),x?(0,p.jsx)(n.A,{"aria-label":"shrink",onClick:b,sx:{position:"absolute",bottom:8,right:8,color:"#fff"},children:(0,p.jsx)(c.Llp,{})}):(0,p.jsx)(n.A,{"aria-label":"expand",onClick:b,sx:{position:"absolute",bottom:8,right:8,color:"#fff"},children:(0,p.jsx)(c.T$Z,{})})]})})]})})]})})}},76918:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});s(65043);var i=s(30589),a=s(21548),n=s(27149),r=s(2127),o=s(70579);const l=e=>{let{statistics:t,trainingGroups:s}=e;const i=[{heading:"Total FFGs",figures:s.length,icon:(0,o.jsx)(n.Itr,{}),color:"#25245D"},{heading:"Registered Farmers",figures:s.map((e=>e.total_participants)).reduce(((e,t)=>e+t),0),icon:(0,o.jsx)(r.qYD,{}),color:"#087C8F"},{heading:"Agronomy Advisors",figures:t.total_bas,icon:(0,o.jsx)(n.rgL,{}),color:"#F46700"}];return(0,o.jsxs)("div",{style:{width:"100%",marginBottom:"20px",display:"flex"},children:[i.map(((e,t)=>(0,o.jsx)("div",{children:(0,o.jsx)(a.A,{heading:e.heading,figures:e.figures,icon:e.icon,color:e.color})},t)))," "]})};var d=s(73216);const c=()=>{const{trainingGroups:e,filter:t,setFilter:s,setFilteredGroups:a,projectStats:n}=(0,d.KC)(),r=e?e.map(((e,t)=>({num:t+1,tg_id:e.tg_id,tg_name:e.tg_name,tns_id:e.tns_id||"N/A",total_participants:e.total_participants,business_advisor:e.business_advisor,farmer_trainer:e.farmer_trainer,status:e.status}))):[];return(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"module__heading",children:"Focal Farmer Groups"}),e.length>0?(0,o.jsxs)("div",{children:[(0,o.jsx)(l,{statistics:n,trainingGroups:e}),(0,o.jsx)(i.A,{columns:[{id:"num",name:"No.",selector:e=>e.num,sortable:!0},{id:"tg_name",name:"FFG Name",selector:e=>e.tg_name,sortable:!0},{id:"tns_id",name:"TNS ID",selector:e=>e.tns_id,sortable:!0},{id:"total_participants",name:"No of Registered Farmers",selector:e=>e.total_participants,sortable:!0},{id:"business_advisor",name:"Business Advisor",selector:e=>e.business_advisor,sortable:!0},{id:"farmer_trainer",name:"Farmer Trainer",selector:e=>e.farmer_trainer,sortable:!0}],data:r,filter:t,setFilter:s,setFilteredGroups:a,tableRowItem:"traingroup"})]}):(0,o.jsx)("div",{className:"no__data",children:(0,o.jsx)("em",{children:"No Active Focal Farmer Groups Found"})})]})}}}]);
//# sourceMappingURL=918.27b5baad.chunk.js.map