"use strict";(self.webpackChunkmypima_front=self.webpackChunkmypima_front||[]).push([[89],{30089:function(e,a,t){t.r(a),t.d(a,{default:function(){return k}});var n,r=t(1413),o=t(93433),s=t(29439),i=t(30168),c=t(72791),d=t(30177),m=t(9383),l=t(32543),h=t(79505),f=t(2339),u=t(90466),y=t(12891),x=t(93137),p=(0,h.z)({chartName:"BarChart",GraphicalChild:f.$,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:u.K},{axisType:"yAxis",AxisComp:y.B}],formatAxisMap:x.t9}),j=t(82839),g=t(71827),v=t(27281),A=t(82165),F=t(62066),P=t(57299),T=t(80184),b=(0,m.Ps)(n||(n=(0,i.Z)(["\n  query GetPerformanceByFT($projectId: String!) {\n    getPerformanceByFT(project_id: $projectId) {\n      message\n      status\n      data {\n        id\n        name\n        monthlyPerformance {\n          month\n          year\n          percentage\n        }\n        monthlyVisitedFarms {\n          month\n          year\n          totalVisitedFarms\n        }\n        monthlyRating {\n          month\n          year\n          avgScore\n        }\n        monthlyAttDifference {\n          month\n          year\n          difference\n          ftAttendance\n          aaAttendance\n        }\n      }\n    }\n  }\n"]))),k=function(e){var a,t=e.selectedProject,n=(0,l.a)(b,{variables:{projectId:t}}),i=n.loading,m=n.error,h=n.data,x=(0,c.useState)(null),k=(0,s.Z)(x,2),N=k[0],w=k[1],B=(0,c.useState)("auto"),D=(0,s.Z)(B,2),K=D[0],S=D[1],V=(0,c.useRef)(null);(0,c.useEffect)((function(){var e;if(V.current&&(null===h||void 0===h||null===(e=h.getPerformanceByFT)||void 0===e?void 0:e.data.length)>0){var a=Math.max.apply(Math,(0,o.Z)(h.getPerformanceByFT.data.map((function(e){return 8*e.name.length}))));S("".concat(a,"px"))}}),[h]);var _=function(e){var a=e.month,t=e.year;return"".concat(a,"/").concat(t)};return(0,T.jsxs)("div",{className:"ft-performance-container",children:[(0,T.jsx)("h4",{className:"page-title",children:"Select a Farmer Trainer"}),(0,T.jsx)("div",{className:"select-download-container",children:i?(0,T.jsx)("p",{className:"loading-message",children:"Loading..."}):m?(0,T.jsx)("p",{className:"error-message",children:"Error: Unable to fetch data. Refresh page, if it doesn't work please contact the PIMA team."}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(d.ZP,{className:"select",options:null===h||void 0===h||null===(a=h.getPerformanceByFT)||void 0===a?void 0:a.data.map((function(e){return{label:e.name,value:e.id}})),onChange:function(e){var a,t=null===h||void 0===h||null===(a=h.getPerformanceByFT)||void 0===a?void 0:a.data.find((function(a){return a.id===e.value}));w(t)},placeholder:"Search Farmer Trainers...",value:N?{label:N.name,value:N.id}:null,styles:{menuPortal:function(e){return(0,r.Z)((0,r.Z)({},e),{},{zIndex:9999})}},menuPortalTarget:document.body,menuPlacement:"auto",width:K,ref:V}),(0,T.jsx)("button",{className:"download-button",onClick:function(){if(h&&h.getPerformanceByFT&&h.getPerformanceByFT.data){var e=[];h.getPerformanceByFT.data.forEach((function(a){a.monthlyPerformance.forEach((function(t,n){var r={Name:a.name,Month:"".concat(t.month,"/").concat(t.year),"% FFGs Submitted":t.percentage||"","Total Visited Farms":"","Average Performance Grade":"","TO vs AA Attendance difference":"","FT Attendance":"","AA Attendance":""},o=a.monthlyVisitedFarms.find((function(e){return e.month===t.month&&e.year===t.year}));o&&(r["Total Visited Farms"]=o.totalVisitedFarms);var s=a.monthlyRating.find((function(e){return e.month===t.month&&e.year===t.year}));s&&(r["Average Performance Grade"]=s.avgScore);var i=a.monthlyAttDifference.find((function(e){return e.month===t.month&&e.year===t.year}));i&&(r["TO vs AA Attendance difference"]=i.difference,r["FT Attendance"]=i.ftAttendance,r["AA Attendance"]=i.aaAttendance),e.push(r)}))}));var a=P.P6.json_to_sheet(e),t=P.P6.book_new();P.P6.book_append_sheet(t,a,"FT_Performance"),P.NC(t,"FT_Performance_Data.xlsx")}},children:"Download Performance Data"})]})}),N&&(0,T.jsxs)("div",{children:[(0,T.jsxs)("h3",{className:"section-title",children:["Graphs for ",N.name]}),(0,T.jsxs)("div",{className:"graph-container",children:[(0,T.jsxs)("div",{className:"graph",children:[(0,T.jsx)("h4",{children:"% of FFGs submitted on PIMA per month"}),(0,T.jsxs)(p,{width:600,height:300,data:N.monthlyPerformance,margin:{top:5,right:30,left:20,bottom:5},children:[(0,T.jsx)(j.q,{strokeDasharray:"3 3"}),(0,T.jsx)(u.K,{dataKey:function(e){var a=e.month,t=e.year;return _({month:a,year:t})},allowDataOverflow:!1}),(0,T.jsx)(y.B,{ticks:[0,20,40,60,80,100]}),(0,T.jsx)(g.u,{}),(0,T.jsx)(v.D,{}),(0,T.jsx)(f.$,{dataKey:"percentage",name:"% FFGs Submitted",fill:"#82ca9d"})]})]}),(0,T.jsxs)("div",{className:"graph",children:[(0,T.jsx)("h4",{children:"Number of Farm Visits performed per month"}),(0,T.jsxs)(A.w,{width:600,height:300,data:N.monthlyVisitedFarms,margin:{top:5,right:30,left:20,bottom:5},children:[(0,T.jsx)(j.q,{strokeDasharray:"3 3"}),(0,T.jsx)(u.K,{dataKey:function(e){var a=e.month,t=e.year;return _({month:a,year:t})}}),(0,T.jsx)(y.B,{}),(0,T.jsx)(g.u,{}),(0,T.jsx)(v.D,{}),(0,T.jsx)(F.x,{type:"monotone",dataKey:"totalVisitedFarms",name:"Farm Visits",stroke:"#8884d8"})]})]}),(0,T.jsxs)("div",{className:"graph",children:[(0,T.jsx)("h4",{children:"FT Average Performance Grade per month"}),(0,T.jsxs)(A.w,{width:600,height:300,data:N.monthlyRating,margin:{top:5,right:30,left:20,bottom:5},children:[(0,T.jsx)(j.q,{strokeDasharray:"3 3"}),(0,T.jsx)(u.K,{dataKey:function(e){var a=e.month,t=e.year;return _({month:a,year:t})}}),(0,T.jsx)(y.B,{ticks:[0,1,2,3,4]}),(0,T.jsx)(g.u,{}),(0,T.jsx)(v.D,{}),(0,T.jsx)(F.x,{type:"monotone",dataKey:"avgScore",name:"Average Performance Grade",stroke:"#ff7300"})]})]}),(0,T.jsxs)("div",{className:"graph",children:[(0,T.jsx)("h4",{children:"FT VS AA Attendance Numbers"}),(0,T.jsxs)(A.w,{width:600,height:300,data:N.monthlyAttDifference,margin:{top:5,right:30,left:20,bottom:5},children:[(0,T.jsx)(j.q,{strokeDasharray:"3 3"}),(0,T.jsx)(u.K,{dataKey:function(e){var a=e.month,t=e.year;return _({month:a,year:t})}}),(0,T.jsx)(y.B,{ticks:[0,20,40,60]}),(0,T.jsx)(g.u,{}),(0,T.jsx)(v.D,{}),(0,T.jsx)(F.x,{type:"monotone",dataKey:"difference",name:"TO vs AA Attendance difference",stroke:"#ff0000"}),(0,T.jsx)(F.x,{type:"monotone",dataKey:"ftAttendance",name:"FT Attendance",stroke:"#00ff00"}),(0,T.jsx)(F.x,{type:"monotone",dataKey:"aaAttendance",name:"AA Attendance",stroke:"#0000ff"})]})]})]})]})]})}}}]);
//# sourceMappingURL=89.3bedf8b9.chunk.js.map