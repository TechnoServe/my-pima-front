"use strict";(self.webpackChunkmypima_front=self.webpackChunkmypima_front||[]).push([[815],{53815:function(e,n,s){s.r(n),s.d(n,{CustomTabPanel:function(){return Ne},a11yProps:function(){return Ue},default:function(){return ke}});var t,r,a,i,o,l,u,c=s(29439),d=s(1413),m=s(45987),p=s(72791),x=s(16029),f=s(4567),h=s(92777),Z=s(43896),g=s(74165),j=s(15861),_=s(57621),b=s(39504),v=s(61889),y=s(66647),P=s(72363),w=s(76053),S=s(4942),C=s(66934),I=s(18137),N=s(17301),U=s(5574),k=s(65661),R=s(81918),E=s(94721),$=s(39157),L=s(68096),D=s(78914),T=s(90493),A=s(84852),B=s(49900),z=s(57064),F=s(97123),q=s(78820),M=s(7692),W=s(73796),G=s(32543),Y=s(84376),V=s(30168),H=s(9383),J=(0,H.Ps)(t||(t=(0,V.Z)(["\n  query GetUsers {\n    getUsers {\n      message\n      status\n      users {\n        user_id\n        sf_user_id\n        user_name\n        user_email\n        mobile_no\n        account_status\n        role {\n          role_id\n          role_name\n        }\n      }\n    }\n  }\n"]))),O=(0,H.Ps)(r||(r=(0,V.Z)(["\n  mutation AddUser(\n    $userName: String!\n    $userEmail: String!\n    $mobileNo: String!\n    $userPassword: String!\n    $roleId: ID\n  ) {\n    addUser(\n      user_name: $userName\n      user_email: $userEmail\n      mobile_no: $mobileNo\n      user_password: $userPassword\n      role_id: $roleId\n    ) {\n      message\n      status\n      user {\n        user_id\n        sf_user_id\n        user_name\n        user_email\n        mobile_no\n        role_id\n        role {\n          role_desc\n          role_id\n          role_name\n          role_status\n        }\n        account_status\n      }\n    }\n  }\n"]))),Q=(0,H.Ps)(a||(a=(0,V.Z)(["\n  mutation UpdateUser(\n    $userId: ID!\n    $accountStatus: String\n    $userEmail: String\n    $mobileNo: String\n    $userName: String\n    $roleId: ID\n  ) {\n    updateUser(\n      user_id: $userId\n      account_status: $accountStatus\n      user_email: $userEmail\n      mobile_no: $mobileNo\n      user_name: $userName\n      role_id: $roleId\n    ) {\n      message\n      status\n      user {\n        user_id\n        sf_user_id\n        user_name\n        user_email\n        mobile_no\n        role_id\n        account_status\n        role {\n          role_id\n          role_name\n          role_desc\n          permissions\n          is_default\n          role_status\n        }\n      }\n    }\n  }\n"]))),X=(0,H.Ps)(i||(i=(0,V.Z)(["\n  query GetRoles {\n    getRoles {\n      message\n      status\n      roles {\n        role_id\n        role_name\n        role_desc\n        permissions\n        is_default\n        role_status\n      }\n    }\n  }\n"]))),K=((0,H.Ps)(o||(o=(0,V.Z)(["\n  query GetRole($roleId: ID!) {\n    getRole(role_id: $roleId) {\n      message\n      status\n      role {\n        role_id\n        role_desc\n        role_name\n        role_status\n      }\n    }\n  }\n"]))),(0,H.Ps)(l||(l=(0,V.Z)(["\n  mutation UpdateRole($roleId: ID!, $permissions: [String]) {\n    updateRole(role_id: $roleId, permissions: $permissions) {\n      message\n      status\n      role {\n        permissions\n        role_id\n        role_desc\n        role_name\n        role_status\n        is_default\n      }\n    }\n  }\n"])))),ee=s(65218),ne=s(56789),se=s(64188),te=s(80184),re=(0,C.ZP)("div")((function(e){var n=e.theme;return(0,S.Z)({position:"relative",borderRadius:n.shape.borderRadius,backgroundColor:(0,I.Fq)(n.palette.common.white,.15),"&:hover":{backgroundColor:(0,I.Fq)(n.palette.common.white,.25)},marginLeft:0,width:"100%"},n.breakpoints.up("sm"),{marginLeft:n.spacing(1),width:"auto"})})),ae=(0,C.ZP)("div")((function(e){return{padding:e.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}})),ie=(0,C.ZP)(N.ZP)((function(e){var n=e.theme;return{color:"inherit","& .MuiInputBase-input":(0,S.Z)({padding:n.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(n.spacing(4),")"),transition:n.transitions.create("width"),width:"100%"},n.breakpoints.up("sm"),{width:"12ch","&:focus":{width:"20ch"}})}})),oe=function(e){var n,s,t=e.open,r=e.handleClose,a=e.title,i=e.data,o=e.selectedProject,l=(0,p.useState)(!1),u=(0,c.Z)(l,2),d=u[0],m=u[1],h=(0,p.useState)([]),Z=(0,c.Z)(h,2),_=Z[0],b=Z[1],v=(0,p.useState)([]),y=(0,c.Z)(v,2),P=y[0],w=y[1],S=(0,p.useState)([]),C=(0,c.Z)(S,2),I=C[0],N=C[1],V=(0,p.useState)(null),H=(0,c.Z)(V,2),O=H[0],K=H[1],oe=(0,p.useState)(null),le=(0,c.Z)(oe,2),ue=le[0],ce=le[1],de=(0,p.useState)(!1),me=(0,c.Z)(de,2),pe=me[0],xe=me[1],fe=(0,p.useState)(!1),he=(0,c.Z)(fe,2),Ze=he[0],ge=he[1],je=(0,G.a)(J),_e=(0,G.a)(X),be=(0,Y.D)(se.N8),ve=(0,c.Z)(be,1)[0],ye=(0,Y.D)(Q),Pe=(0,c.Z)(ye,1)[0];(0,p.useEffect)((function(){b(i)}),[i]),(0,p.useEffect)((function(){je.data&&w(je.data.getUsers.users)}),[je.data]),(0,p.useEffect)((function(){_e.data&&N(_e.data.getRoles.roles)}),[_e.data]);return(0,te.jsxs)(U.Z,{open:t,onClose:r,children:[(0,te.jsxs)(k.Z,{fontSize:"18px",children:[(0,te.jsx)(R.Z,{label:i.length,style:{color:"#333"},variant:"contained"})," ","Users Assigned to"," ",(0,te.jsx)(R.Z,{label:a,color:"primary",variant:"contained"}),(0,te.jsx)(E.Z,{})]}),(0,te.jsx)($.Z,{children:d?(0,te.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,te.jsxs)(L.Z,{sx:{width:"100%"},children:[(0,te.jsx)(f.Z,{variant:"body1",sx:{marginBottom:"10px"},children:"Select User"}),(0,te.jsx)(W.ZP,{name:"user",defaultValue:Ze?null:{value:O,label:P.find((function(e){return e.user_id===O})).user_name},options:P.length>0?P.map((function(e){return{value:e.user_id,label:e.user_name}})):[],onChange:function(e){K(e.value)},className:"basic-multi-select",classNamePrefix:"select"})]}),(0,te.jsxs)(L.Z,{sx:{width:"100%",marginTop:"10px"},children:[(0,te.jsx)(f.Z,{variant:"body1",sx:{marginBottom:"10px"},children:"Select Role"}),(0,te.jsx)(W.ZP,{name:"role",defaultValue:Ze?null:{value:ue,label:I.find((function(e){return e.role_id===ue})).role_name},options:I.length>0?I.map((function(e){return{value:e.role_id,label:e.role_name}})):[],onChange:function(e){ce(e.value)},className:"basic-multi-select",classNamePrefix:"select"})]}),(0,te.jsxs)(x.Z,{sx:{display:"flex",justifyContent:"flex-end",width:"100%",marginTop:"10px"},children:[(0,te.jsx)(D.Z,{variant:"contained",color:"primary",sx:{marginTop:"10px",marginRight:"10px"},onClick:Ze?function(){return(n=n||(0,j.Z)((0,g.Z)().mark((function e(){var n,s;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O||!ue){e.next=9;break}return xe(!0),e.next=4,ve({variables:{userId:O,projectId:o,roleId:ue}});case 4:n=e.sent,200===(s=n.data).addProjectRole.status?(ee.ZP.success(s.addProjectRole.message),K(null),ce(null),xe(!1),m(!1)):(xe(!1),ee.ZP.error(s.addProjectRole.message)),e.next=10;break;case 9:ee.ZP.error("Please select user and role");case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}:function(){return(s=s||(0,j.Z)((0,g.Z)().mark((function e(){var n,s;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O||!ue){e.next=9;break}return xe(!0),e.next=4,Pe({variables:{userId:O,roleId:ue}});case 4:n=e.sent,200===(s=n.data).updateUser.status?(ee.ZP.success(s.updateUser.message),K(null),ce(null),xe(!1),m(!1)):(xe(!1),ee.ZP.error(s.updateUser.message)),e.next=10;break;case 9:ee.ZP.error("Please select user and role");case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)},disabled:pe,children:pe?(0,te.jsx)(ne.Z,{color:"#fff",loading:!0,size:10}):Ze?"Save":"Modify"}),(0,te.jsx)(D.Z,{variant:"contained",color:"error",sx:{marginTop:"10px"},onClick:function(){K(null),ce(null),m(!1)},children:"Cancel"})]})]}):(0,te.jsxs)(T.Z,{children:[(0,te.jsx)(A.ZP,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px 0"},children:(0,te.jsxs)(re,{onChange:function(e){var n=e.target.value,s=i.filter((function(e){return e.user.user_name.toLowerCase().includes(n.toLowerCase())||e.role.role_name.toLowerCase().includes(n.toLowerCase())}));b(s)},children:[(0,te.jsx)(ae,{children:(0,te.jsx)(M.wTD,{})}),(0,te.jsx)(ie,{placeholder:"Search any\u2026",inputProps:{"aria-label":"search"}})]})}),_.length>0?_.map((function(e,n){return(0,te.jsxs)(A.ZP,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px 0"},children:[(0,te.jsx)(B.Z,{primary:e.user?e.user.user_name:"N/A"}),(0,te.jsx)(R.Z,{label:e.role?e.role.role_name:"N/A",color:"secondary",variant:"outlined",size:"small",sx:{marginRight:"10px"}}),(0,te.jsx)(z.Z,{children:(0,te.jsx)(M.Yjd,{size:20,color:"gray",style:{cursor:"pointer"},onClick:function(){K(e.user.user_id),ce(e.role.role_id),m(!0),ge(!1)}})}),(0,te.jsx)(z.Z,{children:(0,te.jsx)(q._nT,{size:20,color:"red"})})]},n)})):(0,te.jsx)(f.Z,{style:{alignSelf:"center"},children:"No users assigned to this project"})]})}),(0,te.jsxs)(F.Z,{children:[!d&&(0,te.jsx)(D.Z,{onClick:function(){m(!0),ge(!0)},color:"primary",children:"Add New"}),(0,te.jsx)(D.Z,{onClick:r,color:"primary",children:"Close"})]})]})},le=s(86586),ue={marginTop:"15px",fontWeight:"400",color:"rgba(125, 127, 136, 1)",fontSize:"12px",maxWidth:"80%"},ce=function(e){var n,s=e.allProjects,t=(0,p.useState)(!1),r=(0,c.Z)(t,2),a=r[0],i=r[1],o=(0,p.useState)([]),l=(0,c.Z)(o,2),u=l[0],d=l[1],m=(0,p.useState)(""),x=(0,c.Z)(m,2),h=x[0],Z=x[1],S=(0,p.useState)(null),C=(0,c.Z)(S,2),I=C[0],N=C[1],U=(0,le.t)(se.Qy),k=(0,c.Z)(U,2),R=k[0],E=k[1].data;return(0,p.useEffect)((function(){if(E&&E.getProjectRolesByProjectId){var e=E.getProjectRolesByProjectId.project_role;d(e),Z(e[0].project.project_name),N(e[0].project.project_id),i(!0)}}),[E]),(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{style:{margin:"10px 0 15px 0"},children:[(0,te.jsx)("h1",{children:"Projects Assignment"}),(0,te.jsx)("p",{style:ue,children:"In the project assignment page you can assign projects to users."})]}),s&&s.length>0?(0,te.jsx)(v.ZP,{container:!0,spacing:2,children:s.map((function(e){return(0,te.jsx)(v.ZP,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,te.jsxs)(_.Z,{sx:{maxWidth:250},children:[(0,te.jsx)(y.Z,{children:(0,te.jsxs)(b.Z,{children:[(0,te.jsx)(f.Z,{gutterBottom:!0,variant:"body1",component:"div",children:e.project_name}),(0,te.jsxs)(f.Z,{variant:"body4",color:"text.secondary",children:["SF Id: ",(0,te.jsx)("em",{children:e.sf_project_id})]})]})}),(0,te.jsx)(P.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,te.jsx)(w.knC,{size:30,style:{cursor:"pointer"},onClick:function(){return function(e){return(n=n||(0,j.Z)((0,g.Z)().mark((function e(n){return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R({variables:{projectId:n.project_id}});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(e)}})})]})},e.project_id)}))}):(0,te.jsx)("p",{children:"No projects found"}),(0,te.jsx)(oe,{open:a,handleClose:function(){return i(!1)},data:u,title:h,selectedProject:I})]})},de=s(93433),me=s(39126),pe=(0,C.ZP)("div")((function(e){var n=e.theme;return(0,S.Z)({position:"relative",borderRadius:n.shape.borderRadius,backgroundColor:(0,I.Fq)(n.palette.common.white,.15),"&:hover":{backgroundColor:(0,I.Fq)(n.palette.common.white,.25)},marginLeft:0,width:"100%"},n.breakpoints.up("sm"),{marginLeft:n.spacing(1),width:"auto"})})),xe=(0,C.ZP)("div")((function(e){return{padding:e.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}})),fe=(0,C.ZP)(N.ZP)((function(e){var n=e.theme;return{color:"inherit","& .MuiInputBase-input":(0,S.Z)({padding:n.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(n.spacing(4),")"),transition:n.transitions.create("width"),width:"100%"},n.breakpoints.up("sm"),{width:"12ch","&:focus":{width:"20ch"}})}})),he=function(e){var n=e.users,s=e.onSelect,t=(0,p.useState)([]),r=(0,c.Z)(t,2),a=r[0],i=r[1];return(0,p.useEffect)((function(){i(n)}),[n]),(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)(pe,{onChange:function(e){var s=e.target.value,t=n.filter((function(e){return e.user_name.toLowerCase().includes(s.toLowerCase())||e.user_email&&e.user_email.toLowerCase().includes(s.toLowerCase())||e.mobile_no&&e.mobile_no.toLowerCase().includes(s.toLowerCase())||e.sf_user_id&&e.sf_user_id.toLowerCase().includes(s.toLowerCase())||e.role.role_name&&e.role.role_name.toLowerCase().includes(s.toLowerCase())}));i(t)},children:[(0,te.jsx)(xe,{children:(0,te.jsx)(M.wTD,{})}),(0,te.jsx)(fe,{placeholder:"Search user\u2026",inputProps:{"aria-label":"search"}})]}),(0,te.jsx)("div",{style:{height:"calc(100vh - 200px)",overflowY:"scroll",marginTop:"20px"},children:a.length>0?a.map((function(e){return(0,te.jsx)(_.Z,{sx:{marginBottom:2},children:(0,te.jsxs)(b.Z,{children:[(0,te.jsxs)(f.Z,{variant:"h6",children:[e.user_name,(0,te.jsx)(R.Z,{label:e.role.role_name,color:"secondary",variant:"outlined",sx:{marginLeft:"10px"}}),"active"!==e.account_status&&(0,te.jsx)(R.Z,{label:e.account_status,color:"error",variant:"contained",sx:{marginLeft:"5px"}})]}),(0,te.jsxs)(x.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,te.jsx)(f.Z,{variant:"subtitle2",children:"Email:"}),(0,te.jsx)(f.Z,{variant:"subtitle1",children:e.user_email||"N/A"})]}),(0,te.jsxs)(x.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,te.jsx)(f.Z,{variant:"subtitle2",children:"Mobile No.:"}),(0,te.jsx)(f.Z,{variant:"subtitle1",children:e.mobile_no||"N/A"})]}),(0,te.jsxs)(x.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,te.jsx)(f.Z,{variant:"subtitle2",children:"SF Id:"}),(0,te.jsx)(f.Z,{variant:"subtitle1",children:e.sf_user_id})]}),(0,te.jsx)(E.Z,{}),(0,te.jsx)(x.Z,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",marginTop:"10px"},children:(0,te.jsx)(me.HlX,{color:"secondary",style:{cursor:"pointer"},title:"Edit User",onClick:function(){return s(e)}})})]})},e.id)})):(0,te.jsx)(f.Z,{variant:"em",align:"center",children:"Please wait while we fetch users..."})})]})},Ze=s(27391),ge=function(e){var n,s=e.onSubmit,t=e.selectedUser,r=e.onSelect,a=(0,p.useState)(!1),i=(0,c.Z)(a,2),o=i[0],l=i[1],u=(0,p.useState)([]),m=(0,c.Z)(u,2),h=m[0],Z=m[1],_=(0,p.useState)(null),b=(0,c.Z)(_,2),v=b[0],y=b[1],P=(0,p.useState)({userName:"",userEmail:"",mobileNo:"",roleId:"",accountStatus:"active"}),w=(0,c.Z)(P,2),S=w[0],C=w[1],I=(0,Y.D)(Q),N=(0,c.Z)(I,1)[0],U=(0,Y.D)(O),k=(0,c.Z)(U,1)[0],R=(0,G.a)(X);(0,p.useEffect)((function(){if(R.data&&R.data.getRoles&&R.data.getRoles.roles&&R.data.getRoles.roles.length>0){var e=R.data.getRoles.roles.map((function(e){return{value:e.role_id,label:e.role_name}}));if(Z(e),t){var n=e.find((function(e){return e.value===t.role.role_id}));y(n)}}}),[R.data]),(0,p.useEffect)((function(){t&&C({userName:t.user_name,userEmail:t.user_email||"",mobileNo:t.mobile_no||"",roleId:t.role.role_id,accountStatus:t.account_status})}),[t]);return(0,te.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,te.jsx)(f.Z,{variant:"h5",sx:{marginBottom:"20px"},children:t?"Edit User":"Add User"}),(0,te.jsxs)("form",{onSubmit:function(e){return(n=n||(0,j.Z)((0,g.Z)().mark((function e(n){var r,a,i,o;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),l(!0),!t){e.next=10;break}return e.next=5,N({variables:{userId:t.user_id,accountStatus:S.accountStatus,userEmail:S.userEmail,mobileNo:S.mobileNo,userName:S.userName,roleId:S.roleId}});case 5:r=e.sent,(a=r.data)&&a.updateUser&&200===a.updateUser.status?(ee.ZP.success("User updated successfully"),s(a.updateUser.user)):ee.ZP.error(a.updateUser.message),e.next=15;break;case 10:return e.next=12,k({variables:{userEmail:S.userEmail,mobileNo:S.mobileNo,userName:S.userName,roleId:S.roleId,userPassword:"MP@1234"}});case 12:i=e.sent,(o=i.data)&&o.addUser&&201===o.addUser.status?(ee.ZP.success("User added successfully"),s(o.addUser.user)):ee.ZP.error(o.addUser.message);case 15:l(!1);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)},children:[(0,te.jsx)(Ze.Z,{label:"Name",value:S.userName,onChange:function(e){return C((0,d.Z)((0,d.Z)({},S),{},{userName:e.target.value}))},variant:"standard",fullWidth:!0}),(0,te.jsx)(Ze.Z,{label:"Email",value:S.userEmail,onChange:function(e){return C((0,d.Z)((0,d.Z)({},S),{},{userEmail:e.target.value}))},variant:"standard",fullWidth:!0}),(0,te.jsx)(Ze.Z,{label:"Mobile No.",value:S.mobileNo,onChange:function(e){return C((0,d.Z)((0,d.Z)({},S),{},{mobileNo:e.target.value}))},variant:"standard",fullWidth:!0}),(0,te.jsxs)(x.Z,{sx:{marginTop:"10px"},children:[(0,te.jsx)(f.Z,{variant:"body1",sx:{marginBottom:"10px"},children:"Role"}),(0,te.jsx)(W.ZP,{name:"role",value:v,options:h,onChange:function(e){y(e),C((0,d.Z)((0,d.Z)({},S),{},{roleId:e.value}))},className:"basic-multi-select",classNamePrefix:"select"})]}),t&&(0,te.jsxs)(x.Z,{sx:{marginTop:"10px"},children:[(0,te.jsx)(f.Z,{variant:"body1",sx:{marginBottom:"10px"},children:"Account Status"}),(0,te.jsx)(W.ZP,{name:"status",value:{value:S.accountStatus,label:S.accountStatus},options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],onChange:function(e){return C((0,d.Z)((0,d.Z)({},S),{},{accountStatus:e.value}))},className:"basic-multi-select",classNamePrefix:"select"})]}),(0,te.jsx)(D.Z,{type:"submit",variant:"contained",color:"primary",style:{marginTop:"20px"},disabled:o||!S.userName||!S.roleId,children:t?"Modify":"Save New"}),t&&(0,te.jsx)(D.Z,{type:"submit",variant:"standard",color:"secondary",style:{marginTop:"20px",marginLeft:"20px"},onClick:function(){r(null),C({userName:"",userEmail:"",mobileNo:"",roleId:"",accountStatus:"active"})},disabled:o,children:"Cancel"})]})]})},je=function(e){var n=e.users,s=e.setUsers,t=(0,p.useState)(null),r=(0,c.Z)(t,2),a=r[0],i=r[1],o=function(e){i(e)};return(0,te.jsxs)(v.ZP,{container:!0,spacing:2,children:[(0,te.jsx)(v.ZP,{item:!0,xs:6,children:!n||n.length<1?(0,te.jsx)(f.Z,{variant:"h6",children:"No users found"}):(0,te.jsx)(he,{users:n,onSelect:o})}),(0,te.jsx)(v.ZP,{item:!0,xs:1}),(0,te.jsx)(v.ZP,{item:!0,xs:5,children:(0,te.jsx)(ge,{onSubmit:function(e){if(e.user_id){var t=n.map((function(n){return n.user_id===e.user_id?e:n}));s(t)}else{var r=[].concat((0,de.Z)(n),[e]);s(r)}},selectedUser:a,onSelect:o})})]})},_e=function(e){var n=e.roles,s=e.onSelectRole,t=(0,p.useState)(0),r=(0,c.Z)(t,2),a=r[0],i=r[1];return(0,te.jsx)(h.Z,{orientation:"vertical",variant:"scrollable",value:a,onChange:function(e,t){i(t),s(n[t])},children:n.map((function(e,n){return(0,te.jsx)(Z.Z,{label:e.role_name.replace(/_/g," ").replace(/\b\w/g,(function(e){return e.toUpperCase()})),style:{alignItems:"flex-start",fontSize:".8rem"},title:e.role_desc},n)}))})},be=s(85523),ve=s(17133),ye=s(45141),Pe=s(50097),we=function(e){e.roles;var n,s=e.role,t=e.permissions,r=e.setRoles,a=(0,p.useState)(s.permissions[0]),i=(0,c.Z)(a,2),o=i[0],l=i[1],u=(0,p.useState)(!1),d=(0,c.Z)(u,2),m=d[0],x=d[1],f=(0,Y.D)(K),h=(0,c.Z)(f,1)[0],Z=function(e){l(e.target.value)};return(0,p.useEffect)((function(){l(s.permissions[0])}),[s]),(0,te.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,te.jsxs)(L.Z,{children:[(0,te.jsxs)(ve.Z,{id:"demo-radio-buttons-group-label",style:{fontWeight:"bold",fontSize:"1rem",color:"#000000"},children:["Permissions for"," ",s.role_name.replace(/_/g," ").replace(/\b\w/g,(function(e){return e.toUpperCase()}))]}),(0,te.jsx)(ye.Z,{"aria-labelledby":"demo-radio-buttons-group-label",name:"radio-buttons-group",children:t&&t.length>0&&t.map((function(e){return(0,te.jsx)(be.Z,{value:e.perm_id,control:(0,te.jsx)(Pe.Z,{onChange:Z,name:e.perm_name,checked:o===e.perm_id}),label:e.perm_name},e.perm_id)}))})]}),(0,te.jsx)(D.Z,{variant:"contained",sx:{width:"150px",mt:5},onClick:function(){return(n=n||(0,j.Z)((0,g.Z)().mark((function e(){return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.next=3,h({variables:{roleId:s.role_id,permissions:[o]}}).then((function(e){200===e.data.updateRole.status?(r((function(e){var n=(0,de.Z)(e),t=n.findIndex((function(e){return e.role_id===s.role_id}));return s.permissions=[o],n[t]=s,n})),x(!1),ee.ZP.success("Permissions updated successfully!")):(x(!1),ee.ZP.error("Something went wrong! Please try again."))})).catch((function(e){console.log(e),ee.ZP.error("Something went wrong! Please try again."),x(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},disabled:o===s.permissions[0]||m,children:"Save Changes"})]})},Se=function(e){var n=e.permissions,s=e.roles,t=e.setRoles,r=(0,p.useState)(s[0]),a=(0,c.Z)(r,2),i=a[0],o=a[1];return(0,te.jsxs)(v.ZP,{container:!0,spacing:2,children:[(0,te.jsx)(v.ZP,{item:!0,xs:3,children:(0,te.jsx)(_e,{roles:s,onSelectRole:function(e){o(e)}})}),(0,te.jsx)(v.ZP,{item:!0,xs:9,children:(0,te.jsx)(we,{roles:s,setRoles:t,role:i,permissions:n})})]})},Ce=(0,H.Ps)(u||(u=(0,V.Z)(["\n  query GetPermissions {\n    getPermissions {\n      message\n      status\n      permissions {\n        perm_id\n        perm_name\n        perm_desc\n        perm_status\n        createdAt\n        updatedAt\n      }\n    }\n  }\n"]))),Ie=["children","value","index"];function Ne(e){var n=e.children,s=e.value,t=e.index,r=(0,m.Z)(e,Ie);return(0,te.jsx)("div",(0,d.Z)((0,d.Z)({role:"tabpanel",hidden:s!==t,id:"simple-tabpanel-".concat(t),"aria-labelledby":"simple-tab-".concat(t)},r),{},{children:s===t&&(0,te.jsx)(x.Z,{sx:{p:3},children:(0,te.jsx)(f.Z,{children:n})})}))}function Ue(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function ke(e){var n=e.allProjects,s=(0,p.useState)(0),t=(0,c.Z)(s,2),r=t[0],a=t[1],i=(0,p.useState)([]),o=(0,c.Z)(i,2),l=o[0],u=o[1],m=(0,p.useState)([]),g=(0,c.Z)(m,2),j=g[0],_=g[1],b=(0,p.useState)([]),v=(0,c.Z)(b,2),y=v[0],P=v[1],w=JSON.parse(window.localStorage.getItem("myPimaUserData")),S=(0,G.a)(J),C=(0,G.a)(Ce),I=(0,G.a)(X);(0,p.useEffect)((function(){S.data&&u(S.data.getUsers.users)}),[S.data]),(0,p.useEffect)((function(){C.data&&_(C.data.getPermissions.permissions)}),[C.data]),(0,p.useEffect)((function(){I.data&&P(I.data.getRoles.roles)}),[I.data]);return(0,te.jsx)(te.Fragment,{children:"super_admin"!==w.role&&"ci_leadership"!==w.role?(0,te.jsx)(f.Z,{variant:"h4",component:"h2",sx:{marginTop:"20px"},children:"You are not authorized to access this page."}):(0,te.jsxs)(x.Z,{sx:{width:"100%",marginTop:"20px"},children:[(0,te.jsx)(x.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,te.jsxs)(h.Z,{value:r,onChange:function(e,n){a(n)},"aria-label":"management tabs",children:[(0,te.jsx)(Z.Z,(0,d.Z)({label:"Assign Projects"},Ue(0))),(0,te.jsx)(Z.Z,(0,d.Z)({label:"Assign Permissions"},Ue(1))),(0,te.jsx)(Z.Z,(0,d.Z)({label:"Users"},Ue(2)))]})}),(0,te.jsx)(Ne,{value:r,index:0,children:(0,te.jsx)(ce,{allProjects:n})}),(0,te.jsx)(Ne,{value:r,index:1,children:(0,te.jsx)(Se,{permissions:j,roles:y,setRoles:P})}),(0,te.jsx)(Ne,{value:r,index:2,children:(0,te.jsx)(je,{users:l,setUsers:u})})]})})}}}]);
//# sourceMappingURL=815.2c74f284.chunk.js.map